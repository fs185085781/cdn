<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>升级界面</title>
    <script src="asserts/js/init.js?from=antd"></script>
    <style>
        .update-font{
            font-size: 14px;
            font-weight: 900;
        }
    </style>
</head>
<body>
<div id="app">
    <a v-if="!hasInit" href="https://gitee.com/fs185085781/kod-plugins/releases" target="_blank">乱码点我去官网下载完整版</a>
    <a-row style="text-align:center;">
        <a-col span="24">
            <span class="update-font">版本号:</span>{{version}}
        </a-col>
        <a-col span="24">
            <span class="update-font">更新内容:</span><div v-html="text"></div>
        </a-col>
        <a-col span="24">
            <a-button type="primary" @click="update(0)">
                直接下载
            </a-button>
            <a-button type="primary" @click="update(1)">
                全量更新(推荐)
            </a-button>
        </a-col>
        <a-col span="24" style="margin-top:5px;">
            <a-button type="primary" @click="update(2)">
                官网下载
            </a-button>
            <a-tooltip placement="top">
                <template slot="title">
                    <span>版本号只相差1位才能补丁更新,否则插件可能不完整</span>
                </template>
                <a-button type="primary" @click="update(3)">
                    补丁更新
                </a-button>
            </a-tooltip>
        </a-col>
    </a-row>
</div>
</body>
<script>
    Vue.app({
        data:{
            version:"",
            text:"",
            downUrl:"",
            actionPhp:"",
            hasInit:false
        },
        methods:{
            update:function (type){
                if(type==0){
                    var a = document.createElement('a');
                    a.href = this.downUrl;
                    a.target = '_blank';
                    a.click();
                }else if(type==2){
                    var a = document.createElement('a');
                    a.href = "https://gitee.com/fs185085781/kod-plugins/releases";
                    a.target = '_blank';
                    a.click();
                }else if(type==1 || type==3){
                    utils.$.get(this.actionPhp+"?type=3&ac="+type+"&version="+this.version,function(res){
                        utils.$.successMsg(res.msg);
                    });
                }
            },
            initData:function (){
                var that = this;
                that.version = window.version;
                that.text = window.text;
                that.downUrl = window.downUrl;
                that.actionPhp = window.actionPhp;
                that.hasInit = true;
            }
        },
        mounted(){
            this.initData();
        }
    });
</script>
</html>