
<body>
<script src="./simpleui-1.0.0/boot.js?mode=angular2&modules=form&skin=blue&lang=zh_CN&profile=product"></script>
<script>
    (function(app) {
        function OutsideService() {}
        OutsideService.prototype = {
            say: function(word) {
                return word;
            }
        };
        var shared = {
            value: 'additional parameter',
            color: 'yellow'
        };
        app.NestComponent =
            ng.core.Component({
                providers: [ng.core.ElementRef],
                selector: '[nestComponent]',
                inputs: ['nestComponent', 'additionalParameter'],
                template: '<div>{{color}} - {{additionalParameter.value}}</div>' +
                '<select><option *ngFor="#item of items" [value]="item.id">{{item.value}}</option></select>'
            })
                .Class({
                    constructor: [ng.core.ElementRef, function(ref) {
                        this.data = shared;
                        this.ref = ref;
                        this.color = null;
                        this.items = [{
                            value: 'banana',
                            id: 1
                        }, {
                            value: 'apple',
                            id: 2
                        }, {
                            value: 'pear',
                            id: 3
                        }];

                        // watch on nestComponent value e.g. <div [nestComponent]="data.color"></div>
                        Object.defineProperty(this, 'nestComponent', {
                            set: function(val) {
                                this.color = val;
                                this.ref.nativeElement.style.backgroundColor = val;
                            }
                        });
                        this.ref.nativeElement.style.backgroundColor = "yellow";
                    }]
                });
        app.AppComponent =
            ng.core.Component({
                selector: 'mainApp',
                template: '<div>{{label}} <input [(ngModel)]="data.color" /></div>' +
                '<div [nestComponent]="data.color" [additionalParameter]="data">Loading...</div>',
                directives: [app.NestComponent],
                providers: [OutsideService]
            })
                .Class({
                    constructor: [OutsideService, function(service) {
                        this.data = shared;
                        this.label = service.say("Color:");
                    }]
                });

        document.addEventListener('DOMContentLoaded', function() {
            ng.platform.browser.bootstrap(app.AppComponent);
        });

    })(window.app || (window.app = {}));
</script>
<mainApp></mainApp>
</body>