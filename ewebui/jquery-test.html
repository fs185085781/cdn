<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script src="./asserts/boot/utils.js?from=pc&lib=jquery&env=test"></script>
	</head>
	<body>
	<div id="datagrid" class="mini-datagrid" showPager="false" ondrawsummarycell="drawsummarycell" summaryRows="3" showSummaryRow="true" frozenStartColumn="0" frozenEndColumn="1" virtualScroll="true" virtualColumns="true" pageSize="5000" style="width:750px;height:250px;" borderStyle="border:0">
		<div property="columns">
			<div type="indexcolumn" ></div>
			<div field="loginname" width="120" headerAlign="center" allowSort="true">员工帐号</div>
			<div field="name" width="120" headerAlign="center" allowSort="true">姓名</div>
			<div header="工作信息">
				<div property="columns">
					<div field="dept_name" name="dept_name" width="120">所属部门</div>
					<div field="position_name" width="100">职位</div>
					<div field="salary" dataType="currency" currencyUnit="￥" align="right" width="100" allowSort="true">薪资</div>
				</div>
			</div>
			<div field="createtime" width="100" headerAlign="center" dateFormat="yyyy-MM-dd" allowSort="true">创建日期</div>
			<div header="基本信息">
				<div property="columns">
					<div field="gender" width="100" renderer="onGenderRenderer">性别</div>
					<div field="age" width="100" allowSort="true" summaryType="avg">年龄</div>
					<div field="birthday" width="100" renderer="onBirthdayRenderer">出生日期</div>
					<div field="married" width="100" align="center" renderer="onMarriedRenderer">婚否</div>
					<div field="email" width="100">邮箱</div>
				</div>
			</div>
			<div header="学历信息">
				<div property="columns">
					<div field="educational_name" width="100">学历</div>
					<div field="school" width="120">毕业院校</div>
				</div>
			</div>
		</div>
	</div>
	<a class="mini-button" onclick="exportData()">导出</a>
	<script>
		mini.parse();
		var datagrid = mini.get("datagrid");
		$.ajax({
            url:"./json/datagrid2.json",
            dataType:"json",
            success:function(res){
                var list = res.data;
                var data = [];
                for(var i=0;i<5000;i++){
                    $.each(list,function(n,item){
                        data[data.length] = item;
                    });
                }
                datagrid.setData(data);
            }
        });
		function drawcell(e){
			//console.log("单元格绘制");
		}
		function exportData(){
			datagrid.exportToExecl({
				fileName:"测试导出",
				needTimeFormat:true/*,
				mergeColumnsMethod:function(){
					datagrid.mergeColumns(["dept_name"]);
				}*/
			})
		}
		function drawsummarycell(e){
			e.cellHtml = Math.random()+"aa";
		}
	</script>
	</body>
</html>
